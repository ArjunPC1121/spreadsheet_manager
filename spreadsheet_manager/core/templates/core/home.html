<!DOCTYPE html>
<html>
<head>
    <title>Upload Spreadsheet</title>
    {% load crispy_forms_tags %}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
    <h2>Upload Your Spreadsheet</h2>

    <form method="POST" enctype="multipart/form-data" class="mb-4">
        {% csrf_token %}
        {{ form|crispy }}
        <button type="submit" class="btn btn-primary">Upload</button>
    </form>

    {% if preview_html %}
        <h3>Original Preview (First 5 rows)</h3>
        <div class="table-responsive">
            {{ preview_html|safe }}
        </div>
    {% endif %}

    {% if processed_preview_html %}
        <h3 class="mt-4">Processed Preview (First 5 rows)</h3>
        <div class="table-responsive">
            {{ processed_preview_html|safe }}
        </div>
        {% if processed_file_url %}
            <a href="{{ processed_file_url }}" class="btn btn-success mt-2" download>
                Download Processed File
            </a>
        {% endif %}
    {% endif %}

</body>
</html>
